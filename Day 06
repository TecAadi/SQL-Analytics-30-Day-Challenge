ðŸ“… Day 06 â€“ Consecutive Numbers
ðŸ”¢ LeetCode 180 â€“ Consecutive Numbers
ðŸ“Œ Problem Statement

Find all numbers that appear at least three times consecutively in the Logs table.

ðŸ—‚ Table Structure
Id	Num
1	1
2	1
3	1
4	2
5	1
6	2
7	2
âœ… Expected Output
ConsecutiveNums
1
ðŸ’¡ Approach

Instead of using multiple self-joins, we use Window Functions:

LAG(Num,1) â†’ Gets previous row value

LAG(Num,2) â†’ Gets value two rows before

Compare current value with previous two rows

Use DISTINCT to remove duplicates

ðŸ’» SQL Solution
SELECT DISTINCT Num AS ConsecutiveNums
FROM (
    SELECT Num,
           LAG(Num,1) OVER (ORDER BY Id) AS prev1,
           LAG(Num,2) OVER (ORDER BY Id) AS prev2
    FROM Logs
) t
WHERE Num = prev1 AND Num = prev2;

ðŸ§  Explanation

The subquery calculates:

Previous value (prev1)

Two rows before value (prev2)

The outer query filters rows where:

Num = prev1 AND Num = prev2


DISTINCT ensures only unique consecutive numbers are returned.

ðŸš€ Key Learnings

Window functions simplify complex joins

LAG() is powerful for row comparison

Understanding ordered data is crucial in SQL
